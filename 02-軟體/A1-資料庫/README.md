

* [Fred Chien: 正規化的效能問題](https://www.facebook.com/fred.chien.9/posts/pfbid0WuQkGPvPV9nUTT67fhchvUvFrQ5JKthCjZnYJwSmi55KuGBQhDqScmTECAKftNxMl)

今天和朋友吃飯聊到近年來資料系統的設計和實作，分享各自的痛苦故事，其中大家已經有個共識，就是對「資料庫正規化」能閃多遠就閃多遠。這落伍卻又被當聖經的東西，已經是所有人的緊箍咒，你之所以會無法改造系統資料流、優化資料處理效率，通常都是因為它的存在。
你微服務拆不好通常是因為它；你資料處理和應用的併發數提不上來，通常也是因為它；你會因為資料庫系統要買一堆鬼怪硬體或資源，更是因為它。
NoSQL 的存在，雖然能部分解決這個問題，但大多數人在使用 NoSQL 的時機，是把其當作正規化後的再合併結果來使用，或是當作資料顆粒度比較大的正規化結果。而這樣還是並沒有逃離正規化的荼毒，導致採用 NoSQL 只是「有機會」減少合併的次數，並非完全避免合併。
所以你會發現，當你因使用 NoSQL 而得到最好成效的場景，就是你把 NoSQL 當 raw data 儲存庫，而你的應用程式也直接利用 raw data 的時候；以及你把 NoSQL 當作快取使用時（因為會針對業務場景進行資料結構優化）。除此之外的大多場景，NoSQL 只是為開發工作帶來便利性，並未帶來什麼效能上的提升。
簡而言之，不管你採用什麼技術或工具，當資料結構能在最少的運算資源消耗下，滿足業務場景需要時，系統才會得到工作效率、效能的最大化。
雖然我知道大學和教科書都會教資料庫正規化，很多人也已經很自然的應用它，甚至在自己程式內的資料結構都是這樣去設計。但資料庫正規化這件事和一般聖經式理論不一樣，它是在早期硬體效能和資源匱乏，且資料應用量還不大的情況下所存在的必要產物，隨著時代變遷，他已經不是必要的存在。若你今天還用這種思維在設計軟體和資料結構，你的資料庫系統就會呈現一 monolith 的狀態。而單體式系統最大的問題往往不是他肥大而已，而是他運算集中、運算密集且無法擴展。 
真心建議客戶和夥伴們，別再輕易採用資料庫正規化的設計，那往往是現代資料系統實現的對立面，更是許多資訊業務系統效能上的敵人。其資料關聯和合併的過程會讓你生不如死，你以為正規化能減少了重複性而省了一點資源，殊不知後面你將付出百倍、千倍以上的代價去使用這些資料，而且這個代價還有可能指數上升，一點都不划算。
至於什麼時候要用資料庫正規化？當你已經確定你的資料走到了應用末端時，剛好應用場景需要正規化的結果時再採用。但以今天的軟體應用複雜度來說，能在一開始瞬間就看透終端應用的資料需求，實在是太難了，更別說我們大家的智商都只是普通人。
我們還是乖乖地先與資料庫正規化保持距離，等到最終業務情境確認時，再去末端軟體上做正規化吧。
#以前使用正規化技巧是為了方便開發且省一些儲存和管理資源 #現在使用正規化是一種過早最佳化的開發設計行為 #無疑是砸自己的腳 #不過你如果開發的是資料量和使用量不高的小系統 #就無所謂了 #雖然你們花幾百萬找我做微服務架構和資料流架構改造設計對我來說還不錯 #但你們明明可以自己避免又何必找我咧 #軟體開發養生之道 #也呼籲商用資料庫系統把授權費訂便宜點啦 #因為改造後會需要更多授權 #你讓客戶怕買授權而不改造 #他們怎麼買更多授權

